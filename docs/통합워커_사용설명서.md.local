# 통합워커 사용 설명서

## 한 줄 요약

**결제 시간에 맞춰 자동으로 "결제재개 → 결제 → 일시중지"를 반복해주는 프로그램**

---

## 왜 필요한가요?

YouTube Premium은 매달 자동 결제됩니다.

```
평소: 일시중지 상태 (결제 안 됨)
      ↓
결제 직전: 결제재개 (결제 가능 상태로 변경)
      ↓
결제 완료: 카드에서 돈 빠져나감
      ↓
결제 직후: 다시 일시중지 (다음 달까지 차단)
```

이걸 수동으로 하면 시간 맞추기가 어렵고, 깜빡하면 결제가 안 됩니다.

**통합워커가 이 과정을 자동으로 해줍니다!**

---

## 시트 준비하기

Google Sheets에 **'통합워커'** 탭을 만들고 아래처럼 작성합니다:

| A열 | B열 | C열 | D열 | E열 | F열 | G열 | H열 | I열 |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 아이디 | 비밀번호 | 복구이메일 | 코드 | 상태 | 다음결제일 | IP | 결과 | 시간 |
| user@gmail.com | mypass123 | recovery@gmail.com | ABCD1234 | 일시중지 | 2025. 1. 26 | | | 7:12 |

### 각 열 설명

| 열 | 이름 | 설명 | 예시 |
|----|------|------|------|
| A | 아이디 | Google 계정 이메일 | user@gmail.com |
| B | 비밀번호 | Google 비밀번호 | mypass123 |
| C | 복구이메일 | 복구용 이메일 (없으면 비워둠) | recovery@gmail.com |
| D | 코드 | 2단계 인증 TOTP 코드 (없으면 비워둠) | ABCD1234EFGH5678 |
| **E** | **상태** | **현재 상태 (중요!)** | `일시중지` 또는 `결제중` |
| F | 다음결제일 | 결제 예정일 | 2025. 1. 26 |
| G | IP | 자동 입력됨 (비워둠) | |
| H | 결과 | 자동 입력됨 (비워둠) | |
| **I** | **시간** | **결제 예정 시각 (중요!)** | 7:12 |

### E열 "상태" 값의 의미

| 상태 값 | 의미 | 워커가 하는 일 |
|---------|------|----------------|
| `일시중지` | 결제 차단 중 | 결제 시간 되면 → `결제중`으로 변경 |
| `결제중` | 결제 가능 상태 | 결제 완료 후 → `일시중지`로 변경 |
| `만료됨` | 구독 만료 | 아무것도 안 함 (무시) |

---

## 실행 방법

### 1. 프로그램 시작

```bash
npm start
```

### 2. 메뉴에서 선택

```
📅 시간체크 통합 워커 (일시중지+재개)
```

### 3. 설정 입력

프로그램이 물어보면 숫자를 입력합니다:

```
? 결제재개 기준 (결제 전 M분): 60
? 일시중지 기준 (결제 후 N분): 30
? 최대 재시도 횟수: 3
? 체크 간격 (초): 60
? 지속 실행 모드? Yes
? 디버그 모드 활성화? No
```

### 4. 설정 의미

| 설정 | 기본값 | 의미 |
|------|--------|------|
| 결제재개 기준 | 10분 | 결제 10분 전에 "결제중" 상태로 변경 |
| 일시중지 기준 | 30분 | 결제 30분 후에 "일시중지" 상태로 변경 |
| 최대 재시도 | 3회 | 실패하면 3번까지 다시 시도 |
| 체크 간격 | 60초 | 60초마다 새로운 대상 확인 |
| 지속 실행 | Yes | 계속 실행 (Ctrl+C로 종료) |

---

## 작동 예시

### 상황: user@gmail.com 계정이 1월 26일 오전 7:12에 결제 예정

**시트 상태:**
```
E열(상태): 일시중지
F열(다음결제일): 2025. 1. 26
I열(시간): 7:12
```

**워커 동작:**

| 시간 | 워커가 하는 일 | E열 변화 |
|------|----------------|----------|
| 6:12 | 결제 60분 전! 결제재개 실행 | 일시중지 → **결제중** |
| 7:12 | (YouTube에서 자동 결제됨) | 결제중 |
| 7:42 | 결제 30분 후! 일시중지 실행 | 결제중 → **일시중지** |

---

## 여러 PC에서 동시에 실행해도 되나요?

**네, 됩니다!**

워커는 J열(잠금)을 사용해서 같은 계정을 동시에 처리하지 않습니다.

```
PC1: user1@gmail.com 처리 중... (J열에 "작업중:PC1:14:35" 기록)
PC2: user1@gmail.com은 잠겨있네? → 다른 계정 처리
```

---

## 종료 방법

키보드에서 **Ctrl + C** 누르면 안전하게 종료됩니다.

```
현재 작업 완료 후 종료됩니다...
```

---

## 결과 확인

작업이 끝나면 H열(결과)에 자동으로 기록됩니다:

| 결과 예시 | 의미 |
|-----------|------|
| ✅ 재개 성공 \| 1/26 07:02 | 결제재개 성공 |
| ✅ 중지 성공 \| 1/26 07:42 | 일시중지 성공 |
| ❌ 로그인 실패 \| 1/26 07:02 | 로그인 실패 (비밀번호 확인) |
| ❌ CAPTCHA \| 1/26 07:02 | 보안 문자 발생 |

---

## 자주 묻는 질문

### Q: 결제가 안 됐어요!

**A: E열 상태를 확인하세요**
- `일시중지`인 상태에서 결제 시간이 지나면 결제가 안 됩니다
- 워커가 제때 `결제중`으로 바꿔야 결제가 됩니다

### Q: 계속 실패해요

**A: L열(재시도) 확인하세요**
- 3번 실패하면 해당 계정은 건너뜁니다
- L열을 비우면 다시 시도합니다

### Q: 2단계 인증이 필요한 계정이에요

**A: D열에 TOTP 코드를 입력하세요**
- Google Authenticator 앱 대신 사용할 비밀 코드입니다
- 32자리 영문+숫자 형식 (예: ABCD1234EFGH5678...)

### Q: 시간은 어떻게 확인하나요?

**A: YouTube Premium 멤버십 페이지에서 확인**
1. YouTube 접속 → 설정 → 멤버십
2. "다음 결제일" 날짜와 시간 확인
3. F열, I열에 각각 입력

---

## 권장 설정

| 상황 | 결제재개 기준 | 일시중지 기준 |
|------|---------------|---------------|
| 일반적인 경우 | 10분 | 30분 |
| 결제가 자주 늦어지는 경우 | 15분 | 60분 |
| 빠르게 차단하고 싶은 경우 | 5분 | 10분 |

---

## 문제 해결

### AdsPower 연결 안 됨
```bash
# AdsPower 프로그램이 실행 중인지 확인
tasklist | findstr "AdsPower"
```

### 브라우저가 안 열림
```bash
# 좀비 프로세스 정리
taskkill /f /im "chrome.exe"
```

---

## 요약

1. **시트 준비**: '통합워커' 탭에 계정 정보 입력
2. **상태 설정**: E열을 `일시중지`로 설정
3. **시간 입력**: F열(날짜), I열(시간) 입력
4. **워커 실행**: `npm start` → 통합워커 선택
5. **자동 처리**: 결제 전 재개, 결제 후 중지 자동 실행
6. **결과 확인**: H열에서 결과 확인

**끝! 이제 결제 시간에 맞춰 자동으로 관리됩니다.**
